# 🔗 JPA 2단계 실습 - 연관관계 매핑

이번 실습의 목표는 JPA에서 **객체 간의 관계**를 테이블 간의 관계와 정확히 매핑하고,  
**단방향/양방향 관계**, **연관관계 주인**, **지연 로딩**, **프록시**, **편의 메서드** 등을 실습하는 것입니다.

---

## ✅ 실습 환경

- Java 17+
- Spring Boot + JPA 설정 완료
- H2 / MySQL 등 RDB 사용
- `spring.jpa.hibernate.ddl-auto=update` 또는 `create`

---

## 📚 실습 과제

---

### 🟡 문제 1. Member ↔ Team 단방향 매핑

**요구사항**

- Member 엔티티에 Team을 단방향으로 매핑하세요.
- 팀과 멤버를 각각 저장하고, 멤버를 조회한 뒤 팀 이름을 출력하세요.

---

### 🟡 문제 2. Member ↔ Team 양방향 매핑

**요구사항**

- Team 엔티티에 members 컬렉션을 추가하여 양방향 관계를 설정하세요.
- 편의 메서드 `addMember(Member member)`를 작성해 관계를 동기화하세요.
- Team을 조회한 뒤, 소속된 모든 Member 이름을 출력하세요.

---

### 🟡 문제 3. 연관관계 주인 확인

**요구사항**

- 연관관계 주인이 누구인지 확인하고, mappedBy의 역할을 실습하세요.
- 연관관계 주인이 아닌 쪽에서 값 변경 시 반영되지 않는 이유를 확인하세요.

---

### 🟡 문제 4. 지연 로딩 확인 (Lazy Loading)

**요구사항**

- Member에서 Team을 지연 로딩으로 설정하세요.
- 프록시 객체가 반환되는지 확인하고, 실제 데이터 접근 시 쿼리가 발생하는지 확인하세요.

---

### 🟡 문제 5. 프록시 객체 확인

**요구사항**

- getReference()를 사용해 프록시 객체를 직접 생성해보세요.
- 프록시 클래스 확인 및 instanceof 체크를 해보세요.

---

### 🟡 문제 6. 연관관계 변경 테스트

**요구사항**

- 멤버를 A팀에서 B팀으로 이동시킨 뒤, 연관관계가 정확히 변경되었는지 확인하세요.
- Team.members 컬렉션이 올바르게 반영되었는지 확인하세요.

---

## 🎯 연습 요약 체크리스트

| 항목                         | 완료 여부 |
|------------------------------|-----------|
| 단방향 연관관계 설정 (`@ManyToOne`) | ✅ / ❌ |
| 양방향 연관관계 설정 (`mappedBy`)    | ✅ / ❌ |
| 연관관계 주인 개념 실험            | ✅ / ❌ |
| 지연 로딩 / 프록시 객체 확인       | ✅ / ❌ |
| 연관관계 변경 및 동기화 테스트     | ✅ / ❌ |
| 편의 메서드로 관계 안정화         | ✅ / ❌ |

---

## 🧠 학습 포인트 요약

| 주제 | 요약 |
|------|------|
| 단방향 매핑 | 외래키는 연관된 엔티티의 PK를 참조함 |
| 양방향 매핑 | `mappedBy`는 읽기 전용, 외래 키는 주인 쪽이 관리 |
| 연관관계 주인 | `@JoinColumn`이 있는 쪽 (대부분 N 쪽) |
| Lazy 로딩 | 실제 접근 전까지 SELECT 쿼리 발생하지 않음 |
| 프록시 | 가짜 객체 → 데이터 접근 시 실제 쿼리 발생 |
| 편의 메서드 | 양방향 연관관계는 양쪽 모두 set 필요 → 실수 방지 |

---

## 🚀 다음 스텝

- 프록시, N+1 문제, Fetch Join 실습
- 실무용 도메인 모델에 연관관계 매핑 적용
- `@OneToMany` 단방향 실습 및 비효율 확인

---

Happy JPA Mapping! 🔗🔥

